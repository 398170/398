{% extends "layout.html" %}
{% block title %}{{ video.title }}{% endblock %}
{% block content %}
<h2>{{ video.title }}</h2>
<p>{{ video.description }}</p>
<p>投稿者: {{ video.uploader }}</p>
<p>タグ: {{ video.tags|join(', ') }}</p>
<p>
    <video width="640" controls>
        <source src="{{ url_for('static', filename='hls/' + video.id + '/index.m3u8') }}" type="application/x-mpegURL">
        サポートされていないブラウザです。
    </video>
</p>

<form action="{{ url_for('like', video_id=video.id) }}" method="get">
    <button type="submit">いいね（{{ video.likes|length }}）</button>
</form>

<h3>コメント</h3>
{% for comment in comments %}
    <div><strong>{{ comment.user }}</strong>: {{ comment.text }}</div>
{% endfor %}

{% if current_user.is_authenticated %}
<form method="post" action="{{ url_for('comment', video_id=video.id) }}">
    <textarea name="comment" placeholder="コメントを書く" required></textarea><br>
    <button type="submit">投稿</button>
</form>
{% else %}
<p><a href="{{ url_for('login') }}">ログイン</a>してコメントしよう！</p>
{% endif %}
{% endblock %}
