{% extends 'layout.html' %}

{% block content %}
  <h2>{{ video.title }}</h2>
  <p>{{ video.description }}</p>

  <video controls width="640">
    <source src="{{ url_for('static', filename='hls/' ~ video.id|string ~ '/index.m3u8') }}" type="application/x-mpegURL">
    お使いのブラウザは動画タグに対応していません。
  </video>

  <h3>コメント</h3>
  <ul>
    {% for comment in comments %}
      <li><strong>{{ comment.username }}:</strong> {{ comment.text }}</li>
    {% else %}
      <li>コメントはまだありません。</li>
    {% endfor %}
  </ul>

  {% if current_user.is_authenticated %}
    <form method="POST">
      <textarea name="comment" required placeholder="コメントを入力してください"></textarea><br>
      <button type="submit">コメントを投稿</button>
    </form>
  {% else %}
    <p><a href="{{ url_for('login') }}">ログイン</a>してコメントを投稿しましょう！</p>
  {% endif %}

{% endblock %}
